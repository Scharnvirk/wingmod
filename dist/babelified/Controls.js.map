{"version":3,"sources":["../../src/Controls.js"],"names":[],"mappings":"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","file":"Controls.js","sourcesContent":["\nclass TopDownControls{\n    constructor(object, domElement) {\n        this.scrollDuration = 4;\n        this.scrollFallOffPercent = 10;\n\n        this.domElement = (domElement !== undefined) ? domElement : document;\n        if (domElement) {\n            this.domElement.setAttribute('tabindex', -1);\n        }\n\n        this.moveState = {};\n\n        this.keys = {\n            87: 'w',\n            83: 's',\n            65: 'a',\n            68: 'd',\n            37: 'left',\n            38: 'up',\n            39: 'right',\n            40: 'down',\n            //mouse below\n            1001: 'scrollUp',\n            1002: 'scrollDown'\n        };\n\n        Object.keys(this.keys).forEach(function (key) {\n            this.moveState[this.keys[key]] = 0;\n        }.bind(this));\n\n        this.keydown = function (event) {\n            if (event.altKey) {\n                return;\n            }\n            if (this.keys.hasOwnProperty(event.keyCode)) {\n                this.moveState[this.keys[event.keyCode]] += 1;\n            }\n        };\n\n        this.keyup = function (event) {\n            if (this.keys.hasOwnProperty(event.keyCode)) {\n                this.moveState[this.keys[event.keyCode]] = 0;\n            }\n        };\n\n        this.mouseWheel = function (event) {\n            this.moveState.scrollUp = event.deltaY > 0 ? this.scrollDuration : 0;\n            this.moveState.scrollDown = event.deltaY < 0 ? this.scrollDuration : 0;\n        };\n\n        this.handleEvent = function (event) {\n            if (typeof this[ event.type ] === 'function') {\n                this[ event.type ](event);\n            }\n        };\n\n        function bind(scope, fn) {\n            return function () {\n                fn.apply(scope, arguments);\n            };\n        }\n\n        function contextmenu(event) {\n            event.preventDefault();\n        }\n\n        this.update = function (delta) {\n            Object.keys(this.moveState).forEach(function (key) {\n                switch(key){\n                    case 'scrollUp':\n                    case 'scrollDown':\n                        if (this.moveState[key] > 0) {\n                            this.moveState[key] *= 1-this.scrollFallOffPercent/100;\n                        }\n                        if (this.moveState[key] < 0.5) {\n                            this.moveState[key] = 0;\n                        }\n                    break;\n                }\n            }.bind(this));\n        };\n\n        this.dispose = function () {\n            this.domElement.removeEventListener('contextmenu', contextmenu, false);\n            this.domElement.removeEventListener('wheel', _wheel, false);\n            window.removeEventListener('keydown', _keydown, false);\n            window.removeEventListener('keyup', _keyup, false);\n        };\n\n        var _keydown = bind(this, this.keydown);\n        var _keyup = bind(this, this.keyup);\n        var _wheel = bind(this, this.mouseWheel);\n\n        this.domElement.addEventListener('contextmenu', contextmenu, false);\n        this.domElement.addEventListener('wheel', _wheel, false);\n        window.addEventListener('keydown', _keydown, false);\n        window.addEventListener('keyup', _keyup, false);\n    }\n}\n"]}